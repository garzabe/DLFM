TODOs: combine the two prepare data functions with an argument to decide if we want time-series data?